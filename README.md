# Low-rank self-play fine-tuning for small LLMs

----

__Expert:__ Andrey Grabovoy

__Consultant:__ Nikita Okhotnikov

----

## Abstract

–í —Ä–∞–±–æ—Ç–µ –∏—Å—Å–ª–µ–¥—É–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–∞ –¥–æ–æ–±—É—á–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (LLM) –≤ —É—Å–ª–æ–≤–∏—è—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤. –ü–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –≤–∏–¥–µ–æ–ø–∞–º—è—Ç—å, —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ —É—á–∞—Å—Ç–∏–µ –∏ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è. –í —Ä–∞–±–æ—Ç–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –º–æ–¥–µ–ª–∏ –¥–æ 0.5B. –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥ –¥–æ–æ–±—É—á–µ–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ LoRA, –º–∞–ª–æ—Ä–∞–Ω–≥–æ–≤—ã—Ö —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–π –º–∞—Ç—Ä–∏—Ü, –≤ —Å–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞, –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ self-play - —Ç–µ–∫—É—â–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –∞ —Å–ª–µ–¥—É—é—â–∞—è –ø–æ–≤—ã—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Å –ø–æ–º–æ—â—å—é —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –æ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö. –ú–µ—Ç–æ–¥ –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –≤–∏–¥–µ–æ–ø–∞–º—è—Ç–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö GPU: Google Colab T4 (16Gb), –∞ —Ç–∞–∫–∂–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–º–∏–º–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –Ω–∞ —ç—Ç–∞–ø–µ SFT. –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–µ—Ç–æ–¥–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≥—Ä—É–ø–ø–∞ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Ç–∞–∫–∏—Ö, –∫–∞–∫ gsm8k, ultrachat\_200k.

----


### –î–∞—Ç–∞—Å–µ—Ç—ã

–î–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è –Ω–∏–∂–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ Qwen2.5-0.5B-Instruct —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–¥–∞–ø–µ—Ç—Ä–æ–≤ LoRA (r=16, alpha=32)

| Dataset                    |                                       Download                                       |
| :----------------------- |:------------------------------------------------------------------------------------:|
| iter0     | ü§ó [HuggingFace](https://huggingface.co/datasets/MuQianyu/qwen2.5-0.5B_lora16_spin0) |
| iter1 | ü§ó [HuggingFace](https://huggingface.co/datasets/MuQianyu/qwen2.5-0.5B_lora16_spin1) |
| SPIN_iter2      | ü§ó [HuggingFace](https://huggingface.co/datasets/MuQianyu/qwen2.5-0.5B_lora16_spin2) |

----

### –ú–æ–¥–µ–ª—å

–¢–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ 

| Model                         |                                  Download                                   |
|:------------------------------|:---------------------------------------------------------------------------:|
| Qwen2.5-0.5B_lora-16_iter-0   | ü§ó [HuggingFace](https://huggingface.co/MuQianyu/qwen2.5-0.5B_lora16_spin0) |
| Qwen2.5-0.5B_lora-16_iter-1   | ü§ó [HuggingFace](https://huggingface.co/MuQianyu/qwen2.5-0.5B_lora16_spin1) |
| Qwen2.5-0.5B_lora-16_iter-2   | ü§ó [HuggingFace](https://huggingface.co/MuQianyu/qwen2.5-0.5B_lora16_spin2) |
